#include <torch/torch.h>
#include <iostream>
#include <torch/script.h> // One-stop header.

#include <opencv2/opencv.hpp>

static std::string classes_label[] = {"plane", "car", "bird", "cat", "deer", "dog", "frog", "horse", "ship", "truck"};
/**
 * GroundTruth:    cat
 * Predicted:    dog
 * Predicted:  97.75
 */
static float g_img_buf[] = {
		61.5000114440918,63.5000114440918,75.50000762939453,77.50000762939453,65.50000762939453,57.5000114440918,69.50000762939453,63.5000114440918,61.5000114440918,63.5000114440918,67.50000762939453,65.50000762939453,67.50000762939453,77.50000762939453,83.50000762939453,85.50000762939453,79.50000762939453,69.50000762939453,65.50000762939453,65.50000762939453,57.5000114440918,43.5000114440918,45.5000114440918,41.5000114440918,43.5000114440918,31.50001335144043,25.50001335144043,27.50001335144043,31.50001335144043,19.50001335144043,0.0,0.0,
		49.5000114440918,47.5000114440918,63.5000114440918,77.50000762939453,69.50000762939453,65.50000762939453,73.50000762939453,69.50000762939453,71.50000762939453,57.5000114440918,55.5000114440918,63.5000114440918,71.50000762939453,85.50000762939453,87.50000762939453,87.50000762939453,83.50000762939453,65.50000762939453,53.5000114440918,47.5000114440918,35.5000114440918,23.50001335144043,25.50001335144043,27.50001335144043,43.5000114440918,39.5000114440918,35.5000114440918,29.50001335144043,31.50001335144043,17.50001335144043,0.0,0.0,
		47.5000114440918,47.5000114440918,61.5000114440918,79.50000762939453,65.50000762939453,71.50000762939453,75.50000762939453,75.50000762939453,71.50000762939453,69.50000762939453,61.5000114440918,59.5000114440918,67.50000762939453,77.50000762939453,79.50000762939453,83.50000762939453,85.50000762939453,63.5000114440918,35.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,13.500014305114746,31.50001335144043,25.50001335144043,29.50001335144043,23.50001335144043,5.500014781951904,0.0,
		55.5000114440918,55.5000114440918,65.50000762939453,93.50000762939453,79.50000762939453,79.50000762939453,83.50000762939453,83.50000762939453,75.50000762939453,75.50000762939453,79.50000762939453,127.50000762939453,99.50000762939453,59.5000114440918,69.50000762939453,73.50000762939453,61.5000114440918,43.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,25.50001335144043,25.50001335144043,17.50001335144043,0.0,
		55.5000114440918,57.5000114440918,67.50000762939453,85.50000762939453,83.50000762939453,71.50000762939453,83.50000762939453,77.50000762939453,73.50000762939453,73.50000762939453,91.50000762939453,237.5,135.5,47.5000114440918,37.5000114440918,29.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,21.50001335144043,11.500014305114746,3.5000150203704834,
		41.5000114440918,11.500014305114746,5.500014781951904,39.5000114440918,67.50000762939453,75.50000762939453,79.50000762939453,79.50000762939453,71.50000762939453,75.50000762939453,71.50000762939453,105.50000762939453,59.5000114440918,1.500015139579773,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.50001335144043,21.50001335144043,13.500014305114746,
		0.0,0.0,0.0,0.0,51.5000114440918,85.50000762939453,81.50000762939453,85.50000762939453,83.50000762939453,77.50000762939453,73.50000762939453,39.5000114440918,3.5000150203704834,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,37.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,27.50001335144043,13.500014305114746,
		7.500014781951904,0.0,0.0,0.0,31.50001335144043,79.50000762939453,75.50000762939453,81.50000762939453,87.50000762939453,67.50000762939453,25.50001335144043,0.0,5.500014781951904,33.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,71.50000762939453,17.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.50001335144043,17.50001335144043,
		85.50000762939453,0.0,0.0,0.0,51.5000114440918,67.50000762939453,71.50000762939453,77.50000762939453,75.50000762939453,93.50000762939453,0.0,0.0,59.5000114440918,57.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,21.50001335144043,37.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.500014305114746,19.50001335144043,
		105.50000762939453,13.500014305114746,0.0,53.5000114440918,93.50000762939453,61.5000114440918,57.5000114440918,51.5000114440918,159.5,219.5,159.5,57.5000114440918,93.50000762939453,41.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,19.50001335144043,31.50001335144043,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,
		111.50000762939453,0.0,29.50001335144043,75.50000762939453,99.50000762939453,55.5000114440918,63.5000114440918,0.0,171.5,219.5,185.5,73.50000762939453,111.50000762939453,57.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,95.50000762939453,59.5000114440918,55.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		121.50000762939453,0.0,15.500014305114746,85.50000762939453,119.50000762939453,77.50000762939453,91.50000762939453,13.500014305114746,0.0,133.5,143.5,85.50000762939453,115.50000762939453,123.50000762939453,13.500014305114746,0.0,0.0,0.0,0.0,0.0,165.5,65.50000762939453,37.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		123.50000762939453,0.0,0.0,95.50000762939453,93.50000762939453,77.50000762939453,101.50000762939453,63.5000114440918,0.0,81.50000762939453,81.50000762939453,19.50001335144043,117.50000762939453,177.5,65.50000762939453,0.0,0.0,0.0,0.0,45.5000114440918,133.5,55.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		123.50000762939453,0.0,49.5000114440918,115.50000762939453,0.0,17.50001335144043,91.50000762939453,79.50000762939453,0.0,39.5000114440918,35.5000114440918,79.50000762939453,123.50000762939453,197.5,105.50000762939453,27.50001335144043,0.0,0.0,0.0,53.5000114440918,117.50000762939453,43.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		133.5,0.0,81.50000762939453,117.50000762939453,0.0,0.0,57.5000114440918,79.50000762939453,0.0,0.0,21.50001335144043,141.5,125.50000762939453,89.50000762939453,35.5000114440918,53.5000114440918,37.5000114440918,0.0,0.0,49.5000114440918,103.50000762939453,19.50001335144043,5.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		139.5,9.500014305114746,89.50000762939453,113.50000762939453,5.500014781951904,0.0,25.50001335144043,55.5000114440918,0.0,5.500014781951904,31.50001335144043,205.5,229.5,35.5000114440918,15.500014305114746,7.500014781951904,0.0,0.0,0.0,33.5000114440918,81.50000762939453,49.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,17.50001335144043,
		151.5,37.5000114440918,81.50000762939453,127.50000762939453,81.50000762939453,0.0,0.0,21.50001335144043,21.50001335144043,0.0,53.5000114440918,91.50000762939453,69.50000762939453,25.50001335144043,0.0,0.0,0.0,0.0,0.0,87.50000762939453,57.5000114440918,41.5000114440918,15.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,47.5000114440918,33.5000114440918,
		173.5,71.50000762939453,73.50000762939453,111.50000762939453,97.50000762939453,0.0,0.0,57.5000114440918,41.5000114440918,0.0,3.5000150203704834,0.0,0.0,0.0,0.0,0.0,0.0,0.0,33.5000114440918,0.0,0.0,1.500015139579773,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,31.50001335144043,45.5000114440918,25.50001335144043,
		169.5,101.50000762939453,79.50000762939453,91.50000762939453,97.50000762939453,0.0,0.0,27.50001335144043,51.5000114440918,15.500014305114746,0.0,0.0,13.500014305114746,0.0,3.5000150203704834,39.5000114440918,0.0,0.0,45.5000114440918,9.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.500014305114746,55.5000114440918,65.50000762939453,53.5000114440918,47.5000114440918,
		143.5,119.50000762939453,87.50000762939453,93.50000762939453,99.50000762939453,33.5000114440918,0.0,0.0,0.0,19.50001335144043,33.5000114440918,0.0,3.5000150203704834,0.0,35.5000114440918,113.50000762939453,0.0,0.0,7.500014781951904,19.50001335144043,13.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,71.50000762939453,87.50000762939453,73.50000762939453,61.5000114440918,43.5000114440918,
		75.50000762939453,135.5,103.50000762939453,99.50000762939453,107.50000762939453,49.5000114440918,0.0,7.500014781951904,87.50000762939453,0.0,0.0,0.0,0.0,0.0,101.50000762939453,127.50000762939453,45.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,33.5000114440918,33.5000114440918,1.500015139579773,0.0,0.0,
		0.0,135.5,99.50000762939453,101.50000762939453,107.50000762939453,21.50001335144043,0.0,45.5000114440918,235.5,183.5,11.500014305114746,13.500014305114746,43.5000114440918,97.50000762939453,125.50000762939453,133.5,81.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,95.50000762939453,93.50000762939453,97.50000762939453,99.50000762939453,25.50001335144043,0.0,167.5,251.5,249.5,161.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,33.5000114440918,81.50000762939453,101.50000762939453,75.50000762939453,75.50000762939453,237.5,251.5,199.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,7.500014781951904,77.50000762939453,9.500014305114746,133.5,253.5,227.5,27.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,1.500015139579773,1.500015139579773,175.5,255.0,119.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,1.500015139579773,193.5,225.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,149.5,167.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,85.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,37.5000114440918,5.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,173.5,57.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.500014781951904,29.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,51.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		67.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.500014305114746,0.0,0.0,27.50001335144043,31.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		97.50000762939453,23.50001335144043,0.0,53.5000114440918,43.5000114440918,0.0,0.0,0.0,105.50000762939453,173.5,105.50000762939453,7.500014781951904,51.5000114440918,7.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,0.0,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		111.50000762939453,0.0,47.5000114440918,83.50000762939453,57.5000114440918,0.0,0.0,0.0,139.5,193.5,127.50000762939453,15.500014305114746,63.5000114440918,19.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,75.50000762939453,39.5000114440918,39.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		127.50000762939453,0.0,33.5000114440918,95.50000762939453,79.50000762939453,0.0,0.0,0.0,0.0,109.50000762939453,87.50000762939453,29.50001335144043,67.50000762939453,87.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,147.5,49.5000114440918,23.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		133.5,0.0,13.500014305114746,105.50000762939453,57.5000114440918,0.0,0.0,0.0,0.0,53.5000114440918,33.5000114440918,0.0,77.50000762939453,149.5,43.5000114440918,0.0,0.0,0.0,0.0,39.5000114440918,119.50000762939453,43.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		129.5,0.0,53.5000114440918,121.50000762939453,0.0,0.0,0.0,0.0,0.0,9.500014305114746,0.0,43.5000114440918,93.50000762939453,177.5,89.50000762939453,7.500014781951904,0.0,0.0,0.0,49.5000114440918,107.50000762939453,33.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		137.5,0.0,79.50000762939453,117.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,115.50000762939453,105.50000762939453,75.50000762939453,25.50001335144043,31.50001335144043,17.50001335144043,0.0,0.0,49.5000114440918,95.50000762939453,11.500014305114746,1.500015139579773,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		139.5,3.5000150203704834,79.50000762939453,101.50000762939453,19.50001335144043,0.0,0.0,0.0,0.0,0.0,7.500014781951904,187.5,217.5,21.50001335144043,5.500014781951904,0.0,0.0,0.0,0.0,13.500014305114746,63.5000114440918,39.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		151.5,37.5000114440918,73.50000762939453,109.50000762939453,85.50000762939453,0.0,0.0,0.0,0.0,0.0,31.50001335144043,71.50000762939453,49.5000114440918,9.500014305114746,0.0,0.0,0.0,0.0,0.0,31.50001335144043,21.50001335144043,27.50001335144043,5.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		175.5,77.50000762939453,79.50000762939453,113.50000762939453,109.50000762939453,0.0,0.0,43.5000114440918,19.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		167.5,113.50000762939453,95.50000762939453,107.50000762939453,113.50000762939453,7.500014781951904,0.0,23.50001335144043,41.5000114440918,1.500015139579773,0.0,0.0,0.0,0.0,0.0,31.50001335144043,0.0,0.0,23.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		129.5,123.50000762939453,97.50000762939453,103.50000762939453,109.50000762939453,43.5000114440918,0.0,0.0,0.0,17.50001335144043,13.500014305114746,0.0,0.0,0.0,13.500014305114746,97.50000762939453,0.0,0.0,0.0,0.0,3.5000150203704834,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		57.5000114440918,131.5,101.50000762939453,91.50000762939453,107.50000762939453,59.5000114440918,0.0,15.500014305114746,95.50000762939453,0.0,0.0,0.0,0.0,0.0,91.50000762939453,109.50000762939453,41.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,145.5,101.50000762939453,83.50000762939453,103.50000762939453,33.5000114440918,0.0,51.5000114440918,239.5,189.5,25.50001335144043,27.50001335144043,57.5000114440918,109.50000762939453,137.5,129.5,89.50000762939453,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,139.5,111.50000762939453,89.50000762939453,99.50000762939453,37.5000114440918,0.0,167.5,249.5,251.5,193.5,31.50001335144043,9.500014305114746,27.50001335144043,11.500014305114746,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,19.50001335144043,81.50000762939453,93.50000762939453,109.50000762939453,85.50000762939453,77.50000762939453,235.5,247.5,207.5,17.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,51.5000114440918,103.50000762939453,17.50001335144043,123.50000762939453,245.5,235.5,63.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,41.5000114440918,17.50001335144043,171.5,251.5,141.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.50001335144043,
		0.0,0.0,0.0,0.0,0.0,35.5000114440918,203.5,235.5,31.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.500014781951904,21.50001335144043,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,183.5,201.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.5000150203704834,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,11.500014305114746,139.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,7.500014781951904,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.500014781951904,57.5000114440918,35.5000114440918,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.500014781951904,37.5000114440918,15.500014305114746,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,73.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		33.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		71.50000762939453,31.50001335144043,0.0,43.5000114440918,0.0,0.0,0.0,0.0,37.5000114440918,141.5,77.50000762939453,0.0,35.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		95.50000762939453,0.0,61.5000114440918,81.50000762939453,0.0,0.0,0.0,0.0,103.50000762939453,197.5,121.50000762939453,7.500014781951904,55.5000114440918,9.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,53.5000114440918,19.50001335144043,21.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		123.50000762939453,0.0,51.5000114440918,101.50000762939453,17.50001335144043,0.0,0.0,0.0,0.0,121.50000762939453,73.50000762939453,11.500014305114746,47.5000114440918,63.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,129.5,29.50001335144043,5.500014781951904,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		133.5,0.0,33.5000114440918,115.50000762939453,11.500014305114746,0.0,0.0,0.0,0.0,49.5000114440918,0.0,0.0,41.5000114440918,111.50000762939453,3.5000150203704834,0.0,0.0,0.0,0.0,25.50001335144043,101.50000762939453,25.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		131.5,0.0,71.50000762939453,129.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,55.5000114440918,145.5,59.5000114440918,0.0,0.0,0.0,0.0,39.5000114440918,93.50000762939453,17.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		137.5,0.0,89.50000762939453,121.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,83.50000762939453,83.50000762939453,63.5000114440918,25.50001335144043,13.500014305114746,0.0,0.0,0.0,43.5000114440918,85.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		139.5,17.50001335144043,93.50000762939453,107.50000762939453,29.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,167.5,205.5,19.50001335144043,5.500014781951904,0.0,0.0,0.0,0.0,0.0,37.5000114440918,21.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		153.5,65.50000762939453,101.50000762939453,121.50000762939453,89.50000762939453,0.0,0.0,0.0,0.0,0.0,11.500014305114746,55.5000114440918,27.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		175.5,105.50000762939453,113.50000762939453,133.5,117.50000762939453,0.0,0.0,35.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		155.5,129.5,123.50000762939453,131.5,121.50000762939453,11.500014305114746,0.0,31.50001335144043,27.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,11.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		105.50000762939453,119.50000762939453,107.50000762939453,115.50000762939453,113.50000762939453,49.5000114440918,0.0,9.500014305114746,5.500014781951904,15.500014305114746,0.0,0.0,0.0,0.0,0.0,81.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		37.5000114440918,119.50000762939453,95.50000762939453,89.50000762939453,105.50000762939453,65.50000762939453,0.0,37.5000114440918,115.50000762939453,0.0,0.0,0.0,0.0,0.0,91.50000762939453,99.50000762939453,41.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		0.0,145.5,97.50000762939453,81.50000762939453,103.50000762939453,39.5000114440918,0.0,63.5000114440918,245.5,195.5,33.5000114440918,39.5000114440918,73.50000762939453,129.5,161.5,139.5,107.50000762939453,31.50001335144043,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
		11.500014305114746,171.5,129.5,99.50000762939453,109.50000762939453,45.5000114440918,0.0,163.5,239.5,249.5,209.5,59.5000114440918,43.5000114440918,69.50000762939453,57.5000114440918,49.5000114440918,41.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.500014781951904,5.500014781951904,15.500014305114746,27.50001335144043,29.50001335144043,9.500014305114746,19.50001335144043,9.500014305114746,
		15.500014305114746,81.50000762939453,121.50000762939453,121.50000762939453,129.5,93.50000762939453,73.50000762939453,219.5,227.5,201.5,51.5000114440918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,9.500014305114746,23.50001335144043,19.50001335144043,19.50001335144043,15.500014305114746,13.500014305114746,23.50001335144043,11.500014305114746,
		27.50001335144043,5.500014781951904,13.500014305114746,97.50000762939453,127.50000762939453,19.50001335144043,107.50000762939453,229.5,235.5,95.50000762939453,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.500014781951904,13.500014305114746,35.5000114440918,29.50001335144043,29.50001335144043,37.5000114440918,33.5000114440918,25.50001335144043,43.5000114440918,
		69.50000762939453,25.50001335144043,0.0,17.50001335144043,79.50000762939453,31.50001335144043,163.5,243.5,155.5,0.0,1.500015139579773,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.500014781951904,13.500014305114746,21.50001335144043,45.5000114440918,49.5000114440918,39.5000114440918,43.5000114440918,53.5000114440918,49.5000114440918,79.50000762939453,109.50000762939453,
		75.50000762939453,39.5000114440918,5.500014781951904,0.0,0.0,73.50000762939453,213.5,239.5,51.5000114440918,0.0,0.0,7.500014781951904,3.5000150203704834,0.0,0.0,0.0,0.0,0.0,0.0,0.0,7.500014781951904,27.50001335144043,45.5000114440918,53.5000114440918,45.5000114440918,27.50001335144043,25.50001335144043,21.50001335144043,61.5000114440918,101.50000762939453,109.50000762939453,83.50000762939453,
		69.50000762939453,43.5000114440918,21.50001335144043,11.500014305114746,0.0,21.50001335144043,211.5,213.5,25.50001335144043,0.0,3.5000150203704834,0.0,11.500014305114746,0.0,0.0,0.0,0.0,0.0,5.500014781951904,9.500014305114746,25.50001335144043,21.50001335144043,23.50001335144043,41.5000114440918,39.5000114440918,23.50001335144043,11.500014305114746,51.5000114440918,109.50000762939453,97.50000762939453,29.50001335144043,23.50001335144043,
		67.50000762939453,39.5000114440918,31.50001335144043,27.50001335144043,21.50001335144043,0.0,63.5000114440918,167.5,0.0,0.0,1.500015139579773,5.500014781951904,23.50001335144043,15.500014305114746,7.500014781951904,0.0,0.0,0.0,5.500014781951904,15.500014305114746,17.50001335144043,23.50001335144043,21.50001335144043,17.50001335144043,15.500014305114746,21.50001335144043,47.5000114440918,101.50000762939453,73.50000762939453,25.50001335144043,0.0,17.50001335144043,
		99.50000762939453,41.5000114440918,19.50001335144043,37.5000114440918,23.50001335144043,9.500014305114746,0.0,11.500014305114746,0.0,0.0,0.0,0.0,1.500015139579773,15.500014305114746,19.50001335144043,1.500015139579773,7.500014781951904,19.50001335144043,23.50001335144043,21.50001335144043,19.50001335144043,17.50001335144043,7.500014781951904,0.0,11.500014305114746,53.5000114440918,103.50000762939453,107.50000762939453,81.50000762939453,37.5000114440918,0.0,0.0,
		81.50000762939453,41.5000114440918,9.500014305114746,31.50001335144043,23.50001335144043,13.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.500015139579773,15.500014305114746,33.5000114440918,57.5000114440918,49.5000114440918,13.500014305114746,0.0,0.0,33.5000114440918,85.50000762939453,139.5,125.50000762939453,73.50000762939453,5.500014781951904,0.0,0.0,
		65.50000762939453,43.5000114440918,9.500014305114746,13.500014305114746,13.500014305114746,9.500014305114746,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.50001335144043,49.5000114440918,35.5000114440918,7.500014781951904,5.500014781951904,0.0,35.5000114440918,79.50000762939453,109.50000762939453,95.50000762939453,35.5000114440918,0.0,3.5000150203704834,0.0
};

int main() {
#ifdef WIN32
	std::string mpath = "C:\\SandyWork\\chongqing_work\\Human-Segmentation-PyTorch\\UNet_MobileNetV2.tar\\UNet_MobileNetV2\\";
	std::string model_path = mpath + "UNet_MobileNetV2.pth";
	model_path = "C:\\SandyWork\\mygithub\\pytorch_learn\\train_cnn_cifar10\\output\\1_12000_loss_1.2831.pts";
	std::string image_path = "../cat.jpg";
#else
	std::string model_path =
			"/home/xiping/mygithub/pytorch_learn/train_cnn_cifar10/output/1_12000_loss_1.2715.pts";
	std::string image_path =
			"/home/xiping/mygithub/pytorch_learn/train_cnn_cifar10/bb.bmp";
	image_path =
			"/home/xiping/mygithub/pytorch_learn/test_cifar10_cpp/build/../../train_cnn_cifar10/ttt.bmp";
#endif

	// cv::Mat image = cv::imread(image_path);
	// cv::Mat rsz;
	// cv::resize(image, rsz, cv::Size(32, 32));
	// cv::namedWindow("test", 1);
	// cv::imshow("test", rsz);
	// cv::waitKey(0);

	torch::Device device = torch::kCPU;
	if (torch::cuda::is_available()) {
		std::cout << "CUDA is available!" << std::endl;
		device = torch::kCUDA;
	} else {
		std::cout << "CUDA is not available!" << std::endl;
	}

	std::cout << "run to:" << __LINE__ << std::endl;
	std::shared_ptr<torch::jit::script::Module> module;
	std::cout << "run to:" << __LINE__ << std::endl;
	std::cout << model_path << std::endl;

	// Deserialize the ScriptModule from a file using torch::jit::load().
	module = torch::jit::load(model_path);
	std::cout << "run to:" << __LINE__ << std::endl;
	assert(module != nullptr);

	if (device == torch::kCUDA) {
		module->to(torch::kCUDA);
	}

	std::vector<torch::jit::IValue> inputs;
	std::cout << "run to:" << __LINE__ << std::endl;

//	at::Tensor tensor_image = torch::from_blob(image.data, {1, 3, image.rows, image.cols}, at::kByte);
//	tensor_image = tensor_image.to(at::kFloat);
//	at::Tensor tensor_image = torch::from_blob(pbuf, {1, 3, 32, 32}, at::kFloat);
	at::Tensor tensor_image = torch::from_blob(g_img_buf, { 1, 3, 32, 32 }, torch::kFloat32).clone();

	std::cout << "run to:" << __LINE__ << std::endl;
	if (device == torch::kCUDA) {
		std::cout << tensor_image.type() << std::endl;
		tensor_image.to(torch::kCUDA);
		std::cout << tensor_image.type() << std::endl;
	}

	std::cout << "run to:" << __LINE__ << std::endl;
	inputs.push_back(tensor_image);
	std::cout << "run to:" << __LINE__ << std::endl;
	// Execute the model and turn its output into a tensor.
	double t1 = cv::getTickCount();
	at::Tensor output = module->forward(inputs).toTensor();
	double t2 = cv::getTickCount();
	std::cout << "Infer time = " << ((t2 - t1)*1000)/cv::getTickFrequency() << std::endl;

	if (device == torch::kCUDA) {
		output = output.to(at::kCPU);	//inference
	}

//	std::cout << output.slice(/*dim=*/1, /*start=*/0, /*end=*/10) << '\n';

	int output_size = 1;
	for (int i = 0; i < output.sizes().size(); i++) {
		output_size *= output.sizes()[i];
	}

	float maxv = -999999;
	int max_label_id = 0;
	for (int i = 0; i < output_size; i++) {
		if (output.data<float>()[i] > maxv) {
			maxv = output.data<float>()[i];
			max_label_id = i;
		}
	}

	std::cout << "Please test your pickle model by pytorch firstly" << std::endl;
	std::cout << "==============================" << std::endl;
	std::cout << "GroundTruth: cat" << std::endl;
	std::cout << "Predicted: " << classes_label[max_label_id] << std::endl;
	std::cout << "Predicted: " << maxv << std::endl;
	std::cout << "==============================" << std::endl;
	return 0;
}
